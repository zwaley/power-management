导入校验与映射报告模板 v0.1 Draft

目标
- 对 Excel《设备表.xlsx》导入过程进行字段别名映射与数据质量校验，并生成可读的报告，便于定位问题与持续完善。

Excel结构约定
- Sheet1：`设备`
  - 关键列：`asset_id`（必填）、`device_name`（或“设备名称”）、`manufacturer`（或“生产厂家”）、`rated_capacity`（或“额定容量”）、`location`（或“局站”）、`in_service_date`（或“投产日期”）、`lifecycle_status_text`
- Sheet2：`连接`
  - 关键列：`from_asset_id`、`from_port`、`to_asset_id`、`to_port`、`cable_type`（或“电力类型”）、`wire_model`（或“线缆型号”）、`a_rated_current`/`b_rated_current`、`installation_date`

处理流程
1) 读取 Excel → 标准化列名（别名映射）
2) 字段级校验（类型、必填、格式）
3) 关联一致性校验（连接中引用的设备/端口存在性）
4) 枚举与单位归一（生命周期、连接类型、容量单位）
5) 生成报告（JSON+人类可读文本），并落盘日志

报告结构（JSON示例）
```
{
  "success": true,
  "summary": {
    "devices_count": 125,
    "connections_count": 420,
    "mapped_aliases": [
      { "from": "manufacturer", "to": "vendor", "sheet": "设备" },
      { "from": "rated_capacity", "to": "power_rating", "sheet": "设备" },
      { "from": "wire_model", "to": "cable_model", "sheet": "连接" }
    ],
    "unrecognized_columns": [
      { "sheet": "设备", "column": "生产商", "suggest": "vendor" }
    ]
  },
  "consistency_issues": [
    { "type": "missing_device", "sheet": "连接", "row": 88, "asset_id": "ASSET_9999" },
    { "type": "missing_port", "sheet": "连接", "row": 102, "asset_id": "ASSET_13", "port_code": "FX" }
  ],
  "value_issues": [
    { "type": "invalid_date", "sheet": "设备", "row": 12, "column": "commission_date", "raw": "2023/13/01" },
    { "type": "non_numeric", "sheet": "连接", "row": 46, "column": "rated_current", "raw": "八十" }
  ],
  "recommendations": [
    "建议在设备Sheet中补充缺失的asset_id，保持唯一性",
    "连接Sheet中的额定电流统一为数字（单位A）",
    "采用标准枚举：lifecycle_status=在役/退役/维修/计划"
  ]
}
```

校验规则细则
- 必填：设备`asset_id`、`name`；连接`from_asset_id`/`to_asset_id`、`from_port`/`to_port`
- 日期：`commission_date`、`installation_date` 必须符合 `YYYY-MM-DD`
- 数值：`rated_current` 为数字；若来源为 `a_rated_current`/`b_rated_current`，按业务规则聚合为单值
- 枚举：`lifecycle_status`、`connection_type` 需在规范值集合内

落盘与可追溯
- 报告JSON：`logs/import_report_<YYYYMMDD_HHMMSS>.json`
- 可读文本：`logs/import_report_<YYYYMMDD_HHMMSS>.md`（摘要+问题列表）
- 若存在严重错误，返回接口 `422` 并附带报告摘要供前端提示

与接口契约的衔接
- 通过映射与校验，确保 `/api/port-topology` 输出的数据完全符合《字段字典与别名映射》文档的规范字段。
- 前端无需兼容多套命名，降低渲染逻辑复杂度。

版本与维护
- 当前版本：v0.1（Draft）
- 维护方式：随着Excel模板迭代，更新“Excel结构约定”和“别名映射”，保持报告内容稳定可读。