# 端口拓扑图设计规范

## 1. 概述

本文档定义了端口拓扑图的设计规范，明确了用户对端口拓扑图的具体需求，以确保开发出符合用户期望的功能。

## 2. 布局规范

### 2.1 中心化布局
- 选中的设备节点必须位于拓扑图中央位置
- 该设备节点代表用户当前查看的核心设备

### 2.2 左右分区原则
- 左右分区仅用于平衡端口展示数量，避免一侧端口过多而显示不下
- 左右分区与端口的上下游关系无关
- 根据端口总数量，将端口平均分配到左右两侧
  - 例如：设备有10个端口，则左侧显示5个，右侧显示5个
  - 如果端口数量为奇数，则左侧多显示一个或右侧多显示一个（保持平衡即可）

### 2.3 端口排列方式
- 左右两侧的端口均按照顺序自上而下排列
- 排列顺序应与数据库中端口的物理顺序一致
- 不考虑端口的上下游关系或其他业务逻辑因素

## 3. 连接线规范

### 3.1 箭头方向控制
端口连接线的箭头方向由数据库中Connection表的"上下游"字段决定：
- 当"上下游"字段值为"上游"时：
  - 箭头方向：从本端设备端口指向对端设备端口
- 当"上下游"字段值为"下游"时：
  - 箭头方向：从对端设备端口指向本端设备端口

### 3.2 连接线样式
- 交流电缆：黄色实线
- 直流电缆：红色实线
- 空闲端口：灰色虚线（无箭头）
- 连接线宽度应与额定电流成正比

## 4. 节点表示规范

### 4.1 本端设备节点
- 显示格式：机房名称 + 设备名称
- 位于拓扑图中央位置

### 4.2 本端端口节点
- 显示格式：端口名称（严格采用用户提交的原始port_name）
- 按照左右分区原则分布在本端设备节点两侧

### 4.3 对端设备节点
- 显示格式：对端设备名称 + 对端端口名称
- 仅显示与本端设备端口有直接连接关系的对端设备端口
- 不显示对端设备的其他无关端口

### 4.4 空闲端口处理
- 没有连接关系的端口仅显示本端端口节点
- 不延伸连接线至对端设备

## 5. 交互功能规范

### 5.1 显示选项
- 提供"显示所有端口"选项：显示设备的所有端口（包括空闲端口）
- 提供"只显示在用端口"选项：仅显示有连接关系的端口

### 5.2 悬停提示
- 鼠标悬停在连接线上时，显示电缆型号等信息
- 鼠标悬停在节点上时，显示设备或端口的详细信息

### 5.3 点击交互
- 点击节点可查看详细信息
- 点击连接线可查看连接详情

### 5.4 拖拽功能
- 用户可以拖拽节点或连接线进行调节
- 调整时只移动用户拖动的元素，其它任何节点和连接线等不要随之变动
- 拖拽操作应提供良好的视觉反馈

### 5.5 全屏显示
- 提供全屏显示按钮
- 点击后拓扑图应占据整个浏览器窗口
- 全屏模式下应保持所有交互功能正常

## 6. 可读性优化

### 6.1 布局算法优化
- 使用布局算法优化节点间距和连接路径
- 避免连接线交叉过多影响可读性
- 在处理多条并行连接时优先考虑层次清晰和电流路径直观

### 6.2 视觉层次
- 通过颜色、形状等视觉元素区分不同类型的节点和连接线
- 确保拓扑图整体清晰易读